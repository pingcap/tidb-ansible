---
# Tasks to configure firewalld rules

- debug: var=firewalld_ports

- name: Determine if firewalld is running
  command: bash -c 'firewall-cmd --state || exit 0' 
  register: firewalld_running
  ignore_errors: true
  changed_when: false

- name: Enable firewalld ports
  firewalld:
    port: '{{item}}'
    permanent: true
    state: enabled
  when: firewalld_running.stdout.strip() == "running"
  with_items: "{{ firewalld_ports }}"
  notify: reload firewalld
